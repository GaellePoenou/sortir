{# a supprimer si besoin #}
{% extends 'base.html.twig' %}


{% block body %}

	{% include 'sorties/filter.html.twig' with {form: form} only%}


	<section class="">
		<div class="container-filtre"></div>
		<table class="tab-liste-sortie">
			<thead>
				<tr>
					<th>Nom de la sortie</th>
					<th>Date de la sortie</th>
					<th>Clotûre</th>
					<th>inscrits/places</th>
					<th>Etat</th>
					<th>Inscrit</th>
					<th>Organisateur</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				{% for sortie in sorties %}
					{#                {% if filtreCampus is empty or sortie.campus is null or sortie.campus.id == filtreCampus %}#}
					<tr>
						<th>{{ sortie.nom }}</th>
						<th>{{ sortie.dateHeureDebut | date('d/m/Y H:i') }}</th>
						<th>{{ sortie.dateLimiteInscription | date('d/m/Y H:i') }}</th>
						<th>{{sortie.participants.count()}}/{{ sortie.nbInscriptionsMax }}</th>
						<th>{{ sortie.etat.libelle }}</th>
						<th>
							{% if sortie.participants.contains(participant) %}✔
							{% endif %}
						</th>
						<th>{{ sortie.organisateur.nom }}</th>
						<th>

							<a href="{{ path('sortie_detail', {'id': sortie.id}) }}" class="btn btn-secondary">Afficher</a>
							{% if is_granted('ROLE_USER') and sortie.dateHeureDebut > 'now' and sortie.etat.libelle is same as('Ouverte') %}
								{% set userIsParticipant = sortie.participants.contains(participant) %}
								{% if userIsParticipant %}
									<a href="{{ path('sortie_desistement', {'id': sortie.id}) }}" class="btn btn-danger">Se désister</a>
								{% else %}
									<a href="{{ path('sortie_inscription', {'id': sortie.id}) }}" class="btn btn-primary">S'inscrire</a>
								{% endif %}
							{% endif %}
						</th>

					</tr>
					{#                {% endif %}#}
				{% endfor %}
			</tbody>
		</table>
	</section>

{% endblock %}

{% block title %}{% endblock %}
